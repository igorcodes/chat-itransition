{"version":3,"sources":["socket.js","reducer.js","components/User.jsx","components/Block.jsx","components/Chat.jsx","App2.js","components/Auth.jsx","App.js","components/Authfb.jsx","index.js"],"names":["socket","io","state","action","type","joined","userName","payload","roomId","users","messages","User","name","imgUrl","Fragment","src","alt","Block","onLogin","React","useState","setUserName","isLoading","setLoading","onEnter","a","obj","axios","post","className","placeholder","value","onChange","e","target","disabled","onClick","Chat","onAddMessage","setMessageValue","messagesRef","useRef","useEffect","current","scrollTo","length","map","index","ref","message","text","emit","messageValue","App2","useReducer","reducer","dispatch","get","data","setUsers","addMessage","on","window","Auth","signIn","gapi","auth2","getAuthInstance","then","googleUser","profile","getBasicProfile","setState","getName","getImageUrl","signOut","_onInit","console","log","_onError","err","load","init","client_id","process","this","class","Component","App","Authfb","login","setLogin","setData","setPicture","appId","autoLoad","fields","scope","callback","response","picture","url","accessToken","icon","Card","Body","Title","Text","email","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"yNAIeA,EAFAC,c,eCFA,WAACC,EAAOC,GACnB,OAAQA,EAAOC,MACb,IAAK,SACH,OAAO,2BACFF,GADL,IAEEG,QAAQ,EACRC,SAAUH,EAAOI,QAAQD,SACzBE,OAAQL,EAAOI,QAAQC,SAG3B,IAAK,WACH,OAAO,2BACFN,GADL,IAEEO,MAAON,EAAOI,QAAQE,MACtBC,SAAUP,EAAOI,QAAQG,WAG7B,IAAK,YACH,OAAO,2BACFR,GADL,IAEEO,MAAON,EAAOI,UAGlB,IAAK,cACH,OAAO,2BACFL,GADL,IAEEQ,SAAS,GAAD,mBAAMR,EAAMQ,UAAZ,CAAsBP,EAAOI,YAGzC,QACE,OAAOL,I,mCC3BTS,EAAO,SAAC,GAAsB,IAApBC,EAAmB,EAAnBA,KAAMC,EAAa,EAAbA,OACpB,OACE,eAAC,IAAMC,SAAP,WACE,uEAAYF,EAAZ,OACA,qBAAKG,IAAKF,EAAQG,IAAI,eC2BbC,MA9Bf,YAA6B,IAAZC,EAAW,EAAXA,QACf,EAA4BC,IAAMC,SAAS,IAA3C,mBACA,GADA,UACgCD,IAAMC,SAAS,KAA/C,mBAAOd,EAAP,KAAiBe,EAAjB,KACA,EAAgCF,IAAMC,UAAS,GAA/C,mBAAOE,EAAP,KAAkBC,EAAlB,KAEMC,EAAO,uCAAG,4BAAAC,EAAA,6DACRC,EAAM,CACVlB,OAAQ,mBACRF,YAEFiB,GAAW,GALG,SAMRI,IAAMC,KAAK,SAAUF,GANb,OAOdR,EAAQQ,GAPM,2CAAH,qDAUb,OACE,sBAAKG,UAAU,aAAf,UACE,uBACEzB,KAAK,OACL0B,YAAY,qBACZC,MAAOzB,EACP0B,SAAU,SAACC,GAAD,OAAOZ,EAAYY,EAAEC,OAAOH,UAExC,wBAAQI,SAAUb,EAAWc,QAASZ,EAASK,UAAU,kBAAzD,SACGP,EAAY,UAAY,cC2ClBe,MApEf,YAAoE,IAApD5B,EAAmD,EAAnDA,MAAOC,EAA4C,EAA5CA,SAAUJ,EAAkC,EAAlCA,SAAUE,EAAwB,EAAxBA,OAAQ8B,EAAgB,EAAhBA,aACjD,EAAwCnB,IAAMC,SAAS,IAAvD,mBAAqBmB,GAArB,WACMC,EAAcrB,IAAMsB,OAAO,MA4BjC,OAJAtB,IAAMuB,WAAU,WACdF,EAAYG,QAAQC,SAAS,EAAG,SAC/B,CAAClC,IAGF,sBAAKmB,UAAU,OAAf,UACE,sBAAKA,UAAU,aAAf,mBACQ,4BAAIrB,IACV,uBACA,yCAAYC,EAAMoC,OAAlB,QACA,6BACGpC,EAAMqC,KAAI,SAAClC,EAAMmC,GAAP,OACT,6BAAwBnC,GAAfA,EAAOmC,WAItB,sBAAKlB,UAAU,gBAAf,UACE,qBAAKmB,IAAKR,EAAaX,UAAU,WAAjC,SACGnB,EAASoC,KAAI,SAACG,GAAD,OACZ,sBAAKpB,UAAU,UAAf,UACE,4BAAIoB,EAAQC,OACZ,8BACE,+BAAO,WAAaD,EAAQ3C,qBAKpC,iCAEE,wBAAQ8B,QAnDM,WACpBpC,EAAOmD,KAAK,mBAAoB,CAC9B7C,WACAE,SACA0C,KAAM,YACNE,aAAc,cAEhBd,EAAa,CAAEhC,WAAU4C,KAAM,cAC/BX,EAAgB,KA2CsBnC,KAAK,SAASyB,UAAU,kBAAxD,uBAIA,wBAAQO,QA5CO,WACrBpC,EAAOmD,KAAK,mBAAoB,CAC9B7C,WACAE,SACA0C,KAAM,YACNE,aAAc,cAEhBd,EAAa,CAAEhC,WAAU4C,KAAM,cAC/BX,EAAgB,KAoCuBnC,KAAK,SAASyB,UAAU,kBAAzD,iCCAKwB,MArDf,WACE,MAA0BlC,IAAMmC,WAAWC,EAAS,CAClDlD,QAAQ,EACRG,OAAQ,KACRF,SAAU,KACVG,MAAO,GACPC,SAAU,KALZ,mBAAOR,EAAP,KAAcsD,EAAd,KAQMtC,EAAO,uCAAG,WAAOQ,GAAP,iBAAAD,EAAA,6DACd+B,EAAS,CACPpD,KAAM,SACNG,QAASmB,IAEX1B,EAAOmD,KAAK,YAAazB,GALX,SAMSC,IAAM8B,IAAN,iBAAoB/B,EAAIlB,SANjC,gBAMNkD,EANM,EAMNA,KACRF,EAAS,CACPpD,KAAM,WACNG,QAASmD,IATG,2CAAH,sDAaLC,EAAW,SAAClD,GAChB+C,EAAS,CACPpD,KAAM,YACNG,QAASE,KAIPmD,EAAa,SAACX,GAClBO,EAAS,CACPpD,KAAM,cACNG,QAAS0C,KAYf,OAPA9B,IAAMuB,WAAU,WACd1C,EAAO6D,GAAG,iBAAkBF,GAC5B3D,EAAO6D,GAAG,mBAAoBD,KAC7B,IAEDE,OAAO9D,OAASA,EAGhB,qBAAK6B,UAAU,UAAf,SAEI3B,EAAMG,OAA4C,cAAC,EAAD,2BAAUH,GAAV,IAAiBoC,aAAcsB,KAAjE,cAAC,EAAD,CAAO1C,QAASA,OCpDlC6C,E,4MACJ7D,MAAQ,CACNU,KAAM,KACNC,OAAQ,M,EAmBVmD,OAAS,WACOF,OAAOG,KAAKC,MAAMC,kBAC1BH,SAASI,MAAK,SAAAC,GAClB,IAAMC,EAAUD,EAAWE,kBAC3B,EAAKC,SAAS,CACZ5D,KAAM0D,EAAQG,UACd5D,OAAQyD,EAAQI,oB,EAItBC,QAAU,WACMb,OAAOG,KAAKC,MAAMC,kBAC1BQ,UAAUP,MAAK,WACnB,EAAKI,SAAS,CACZ5D,KAAM,KACNC,OAAQ,W,uDAhCd,WACE,IAAM+D,EAAU,SAAAV,GACdW,QAAQC,IAAI,UAAWZ,IAEnBa,EAAW,SAAAC,GACfH,QAAQC,IAAI,QAASE,IAEvBlB,OAAOG,KAAKgB,KAAK,SAAS,WACxBnB,OAAOG,KAAKC,MACTgB,KAAK,CACJC,UAAWC,8EAEZhB,KAAKQ,EAASG,Q,oBA2BrB,WAEE,MAAyBM,KAAKnF,MAAtBU,EAAR,EAAQA,KAAMC,EAAd,EAAcA,OACd,OACE,qBAAKgB,UAAU,MAAf,SACE,yBAAQA,UAAU,aAAlB,WAGIjB,GAAQ,wBAAQ0E,MAAM,kBAAkBlD,QAASiD,KAAKrB,OAA9C,iCAERpD,GAAQ,mBAAG0E,MAAM,mBAAT,wCACP1E,GAAQ,cAAC,EAAD,MACRA,GAAQ,cAAC,EAAD,CAAMA,KAAMA,EAAMC,OAAQA,a,GAxD5B0E,aA+DJxB,ICJAyB,MAvDf,WACE,MAA0BrE,IAAMmC,WAAWC,EAAS,CAClDlD,QAAQ,EACRG,OAAQ,KACRF,SAAU,KACVG,MAAO,GACPC,SAAU,KALZ,mBAAc8C,GAAd,WAqBSG,EAAW,SAAClD,GACjB+C,EAAS,CACPpD,KAAM,YACNG,QAASE,KAIPmD,EAAa,SAACX,GAClBO,EAAS,CACPpD,KAAM,cACNG,QAAS0C,KAgBf,OAZA9B,IAAMuB,WAAU,WACd1C,EAAO6D,GAAG,iBAAkBF,GAC5B3D,EAAO6D,GAAG,mBAAoBD,KAC7B,IAEDE,OAAO9D,OAASA,EAQhB,sBAAK6B,UAAU,UAAf,UACC,cAAC,EAAD,IADD,Q,iCCNW4D,MA9Cf,WAEE,MAA0BrE,oBAAS,GAAnC,mBAAOsE,EAAP,KAAcC,EAAd,KACA,EAAwBvE,mBAAS,IAAjC,mBAAOsC,EAAP,KAAakC,EAAb,KACA,EAA8BxE,mBAAS,IAAvC,mBAAgByE,GAAhB,WAaA,OACE,sBAAKP,MAAM,YAAX,WAEQI,GACA,cAAC,IAAD,CACEI,MAAM,kBACNC,UAAU,EACVC,OAAO,qBACPC,MAAM,8BACNC,SApBa,SAACC,GACxBtB,QAAQC,IAAI,kBAAoBqB,GAChCP,EAAQO,GACRN,EAAWM,EAASC,QAAQ1C,KAAK2C,KAC7BF,EAASG,YACXX,GAAS,GAETA,GAAS,IAcDY,KAAK,gBAERb,GACC,cAAC,EAAD,IAEJ,cAACc,EAAA,EAAD,UACCd,GACC,eAACc,EAAA,EAAKC,KAAN,WACE,cAACD,EAAA,EAAKE,MAAN,UAAahD,EAAK9C,OAClB,cAAC4F,EAAA,EAAKG,KAAN,UACGjD,EAAKkD,iBCnCpBC,IAASC,OACP,eAAC,IAAMC,WAAP,WACG,cAAC,EAAD,IADH,IAEG,cAAC,EAAD,IAFH,OAKAC,SAASC,eAAe,W","file":"static/js/main.fe1bc221.chunk.js","sourcesContent":["import io from 'socket.io-client'; \r\n\r\nconst socket = io();\r\n\r\nexport default socket;","export default (state, action) => {\r\n    switch (action.type) {\r\n      case 'JOINED':\r\n        return {\r\n          ...state,\r\n          joined: true,\r\n          userName: action.payload.userName,\r\n          roomId: action.payload.roomId,\r\n        };\r\n  \r\n      case 'SET_DATA':\r\n        return {\r\n          ...state,\r\n          users: action.payload.users,\r\n          messages: action.payload.messages,\r\n        };\r\n  \r\n      case 'SET_USERS':\r\n        return {\r\n          ...state,\r\n          users: action.payload,\r\n        };\r\n  \r\n      case 'NEW_MESSAGE':\r\n        return {\r\n          ...state,\r\n          messages: [...state.messages, action.payload],\r\n        };\r\n  \r\n      default:\r\n        return state;\r\n    }\r\n  };","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst User = ({ name, imgUrl }) => {\r\n  return (\r\n    <React.Fragment>\r\n      <p>Привет, {name}!</p>\r\n      <img src={imgUrl} alt=\"profle\" />\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nUser.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  imgUrl: PropTypes.string.isRequired,\r\n}\r\n\r\nexport { User }","import React from 'react';\r\nimport axios from 'axios';\r\nimport Auth from './Auth';\r\n\r\nfunction Block({ onLogin }) {\r\n  const [roomId, setRoomId] = React.useState('');\r\n  const [userName, setUserName] = React.useState('');\r\n  const [isLoading, setLoading] = React.useState(false);\r\n\r\n  const onEnter = async () => {\r\n    const obj = {\r\n      roomId: 'Itransition Chat',\r\n      userName,\r\n    };\r\n    setLoading(true);\r\n    await axios.post('/rooms', obj);\r\n    onLogin(obj);\r\n  };\r\n\r\n  return (\r\n    <div className=\"join-block\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Your Chat Nickname\"\r\n        value={userName}\r\n        onChange={(e) => setUserName(e.target.value)}\r\n      />\r\n      <button disabled={isLoading} onClick={onEnter} className=\"btn btn-success\">\r\n        {isLoading ? 'ENTER..' : 'ENTER'}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Block;","import React from 'react';\r\nimport socket from '../socket';\r\n\r\nfunction Chat({ users, messages, userName, roomId, onAddMessage }) {\r\n  const [messageValue, setMessageValue] = React.useState('');\r\n  const messagesRef = React.useRef(null);\r\n\r\n  const onSendMessage = () => {\r\n    socket.emit('ROOM:NEW_MESSAGE', {\r\n      userName,\r\n      roomId,\r\n      text: \"Hello Bro\",\r\n      messageValue: \"Hello Bro\",\r\n    });\r\n    onAddMessage({ userName, text: \"Hello Bro\" });\r\n    setMessageValue('');\r\n  };\r\n\r\n  const onSendMessage2 = () => {\r\n    socket.emit('ROOM:NEW_MESSAGE', {\r\n      userName,\r\n      roomId,\r\n      text: \"Hello Sis\",\r\n      messageValue: \"Hello Sis\",\r\n    });\r\n    onAddMessage({ userName, text: \"Hello Sis\" });\r\n    setMessageValue('');\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    messagesRef.current.scrollTo(0, 99999);\r\n  }, [messages]);\r\n\r\n  return (\r\n    <div className=\"chat\">\r\n      <div className=\"chat-users\">\r\n        Room: <b>{roomId}</b>\r\n        <hr />\r\n        <b>Online ({users.length}):</b>\r\n        <ul>\r\n          {users.map((name, index) => (\r\n            <li key={name + index}>{name}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div className=\"chat-messages\">\r\n        <div ref={messagesRef} className=\"messages\">\r\n          {messages.map((message) => (\r\n            <div className=\"message\">\r\n              <p>{message.text}</p>\r\n              <div>\r\n                <span>{'Sent by ' + message.userName}</span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <form>\r\n          \r\n          <button onClick={onSendMessage} type=\"button\" className=\"btn btn-primary\">\r\n            Hello Bro\r\n          </button>\r\n\r\n          <button onClick={onSendMessage2} type=\"button\" className=\"btn btn-primary\">\r\n          Hello Sis\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport socket from './socket';\r\n\r\nimport reducer from './reducer';\r\nimport Block from './components/Block';\r\nimport Chat from './components/Chat';\r\n\r\nfunction App2() {\r\n  const [state, dispatch] = React.useReducer(reducer, {\r\n    joined: false,\r\n    roomId: null,\r\n    userName: null,\r\n    users: [],\r\n    messages: [],\r\n  }); \r\n\r\n  const onLogin = async (obj) => {\r\n    dispatch({\r\n      type: 'JOINED', \r\n      payload: obj,\r\n    }); \r\n    socket.emit('ROOM:JOIN', obj);\r\n    const { data } = await axios.get(`/rooms/${obj.roomId}`);\r\n    dispatch({\r\n      type: 'SET_DATA',\r\n      payload: data,\r\n    });\r\n  };\r\n    \r\n    const setUsers = (users) => {\r\n      dispatch({\r\n        type: 'SET_USERS',\r\n        payload: users,\r\n      });\r\n    };\r\n\r\n    const addMessage = (message) => {\r\n      dispatch({\r\n        type: 'NEW_MESSAGE',\r\n        payload: message,\r\n      });\r\n    };\r\n\r\n\r\n  React.useEffect(() => {\r\n    socket.on('ROOM:SET_USERS', setUsers);\r\n    socket.on('ROOM:NEW_MESSAGE', addMessage);\r\n  }, []);\r\n\r\n    window.socket = socket;\r\n\r\n  return (\r\n    <div className=\"wrapper\"> \r\n    \r\n      {!state.joined ? (<Block onLogin={onLogin} /> ) : ( <Chat {...state} onAddMessage={addMessage} /> )}\r\n      \r\n      </div>\r\n  );\r\n}\r\n    \r\nexport default App2;\r\n\r\n","import React, { Component } from 'react'\r\nimport { User } from './User'\r\nimport App2 from '../App2';\r\n\r\nclass Auth extends Component {\r\n  state = {\r\n    name: null,\r\n    imgUrl: null,\r\n  }\r\n  componentDidMount() {\r\n    const _onInit = auth2 => {\r\n      console.log('init OK', auth2)\r\n    }\r\n    const _onError = err => {\r\n      console.log('error', err)\r\n    }\r\n    window.gapi.load('auth2', function() {\r\n      window.gapi.auth2\r\n        .init({\r\n          client_id: process.env.REACT_APP_GOOGLE_CLIENT_ID,\r\n        })\r\n        .then(_onInit, _onError)\r\n    })\r\n  }\r\n\r\n  \r\n  signIn = () => {\r\n    const auth2 = window.gapi.auth2.getAuthInstance()\r\n    auth2.signIn().then(googleUser => {\r\n      const profile = googleUser.getBasicProfile()\r\n      this.setState({\r\n        name: profile.getName(),\r\n        imgUrl: profile.getImageUrl(),\r\n      })\r\n    })\r\n  }\r\n  signOut = () => {\r\n    const auth2 = window.gapi.auth2.getAuthInstance()\r\n    auth2.signOut().then(() => {\r\n      this.setState({\r\n        name: null,\r\n        imgUrl: null,\r\n      })\r\n    })\r\n  }\r\n\r\n  \r\n\r\n  render() {\r\n    \r\n    const { name, imgUrl } = this.state\r\n    return (\r\n      <div className=\"App\">\r\n        <header className=\"App-header\">\r\n\r\n\r\n          {!name && <button class=\"btn btn-primary\" onClick={this.signIn}>  Google Sign In  </button>}\r\n          \r\n          {!name && <p class=\"font-weight-bold\">  10000 Bro!  20000 Sis!</p>}\r\n          {!!name && <App2 />}\r\n          {!!name && <User name={name} imgUrl={imgUrl} />}\r\n        </header>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Auth;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\nimport axios from 'axios';\nimport socket from './socket';\n\nimport reducer from './reducer';\nimport Auth from './components/Auth';\n\n\nfunction App() {\n  const [state, dispatch] = React.useReducer(reducer, {\n    joined: false,\n    roomId: null,\n    userName: null,\n    users: [],\n    messages: [],\n  }); \n\n  const onLogin = async (obj) => {\n    dispatch({\n      type: 'JOINED',  \n      payload: obj,\n    }); \n    socket.emit('ROOM:JOIN', obj);  \n    const { data } = await axios.get(`/rooms/${obj.roomId}`);\n    dispatch({\n      type: 'SET_DATA',\n      payload: data,\n    });\n  };\n    \n     const setUsers = (users) => {\n      dispatch({\n        type: 'SET_USERS',\n        payload: users,\n      });\n    };\n\n    const addMessage = (message) => {\n      dispatch({\n        type: 'NEW_MESSAGE',\n        payload: message,\n      });\n    };\n\n  React.useEffect(() => {\n    socket.on('ROOM:SET_USERS', setUsers);\n    socket.on('ROOM:NEW_MESSAGE', addMessage);\n  }, []);\n\n    window.socket = socket;\n\n\n    const onSuccess = response => console.log(response);\n    const onFailure = response => console.error(response);\n \n\n  return (\n    <div className=\"wrapper\"> \n     <Auth/>,\n    </div>\n  );\n}\n    \nexport default App;\n\n","import React, { useState } from 'react';\r\nimport FacebookLogin from 'react-facebook-login';\r\nimport { Card, Image } from 'react-bootstrap';\r\nimport App2 from '../App2';\r\n\r\nfunction Authfb() {\r\n\r\n  const [login, setLogin] = useState(false);\r\n  const [data, setData] = useState({});\r\n  const [picture, setPicture] = useState('');\r\n\r\n  const responseFacebook = (response) => {\r\n    console.log('response Authfb' + response);\r\n    setData(response);\r\n    setPicture(response.picture.data.url);\r\n    if (response.accessToken) {\r\n      setLogin(true);\r\n    } else {\r\n      setLogin(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div class=\"container\">\r\n      \r\n          {!login &&\r\n            <FacebookLogin\r\n              appId=\"610136123510751\"\r\n              autoLoad={false}\r\n              fields=\"name,email,picture\"\r\n              scope=\"public_profile,user_friends\"\r\n              callback={responseFacebook}\r\n              icon=\"fa-facebook\" />\r\n          }\r\n          {login &&\r\n            <App2 />\r\n          }\r\n        <Card>\r\n        {login &&\r\n          <Card.Body>\r\n            <Card.Title>{data.name}</Card.Title>\r\n            <Card.Text>\r\n              {data.email}\r\n            </Card.Text>\r\n          </Card.Body>\r\n        }\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Authfb;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\nimport Authfb from './components/Authfb';\n\n\nReactDOM.render(\n  <React.StrictMode>\n     <Authfb />,\n     <App />,\n     \n  </React.StrictMode>,\n  document.getElementById('root'),\n);"],"sourceRoot":""}